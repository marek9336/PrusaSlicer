pipeline
{
	agent 
	{
    		docker
		{
        		image 'maven:3-alpine'
        		label 'Docker_label'
        		args  '-v /tmp:/tmp'
    		}
    	}
	stages 
	{
		stage('Preparation')
		{
			steps
			{
				
				sh 'mkdir -p build && cd build && pwd'
				cmake(installation: 'cmake', arguments: '--version')
				cmake(installation: 'cmake', arguments: '--help')
				sh 'apt-get install make'
			}
		}
		stage('Build')
		{
			steps
			{
				sh 'cat /var/jenkins_home/workspace/slicer_pipe/build/CMakeFiles/CMakeOutput.log'
				
				//cmake arguments: '-DCMAKE_TOOLCHAIN_FILE=~/Projects/vcpkg/scripts/buildsystems/vcpkg.cmake', installation: 'cmake'
                		//cmakeBuild buildType: 'Release', cleanBuild: true, installation: 'cmake', steps: [[withCmake: true]]				
				
				sh 'pwd'
				
				cmake(installation: 'cmake', arguments: '-S . -B ./build')
				//make -j8
			}
		}
	}
}
